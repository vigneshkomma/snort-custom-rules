# 1. Detect HTTPS Connection to a Specific Domain (e.g., github.com)
# The 'content' matches the domain name in the cleartext TLS Client Hello packet.
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"HTTPS Site Access: GitHub Detected"; flow:to_server,established; content:"github.com"; nocase; sid:4000001; rev:1;)

# 2. Detect Outdated/Insecure TLS (SSLv3)
# Attackers use old versions because they are easier to crack.
# This looks for the hex code for SSLv3 in the handshake.
alert tcp $EXTERNAL_NET any -> $HOME_NET 443 (msg:"Insecure HTTPS: SSLv3 Handshake Detected"; flow:to_server,established; content:"|16 03 00|"; depth:3; sid:4000002; rev:1;)

# 3. Detect HTTPS Port Scan (SYN Scan)
# Similar to your other scan rules, but specific to port 443.
alert tcp $EXTERNAL_NET any -> $HOME_NET 443 (msg:"HTTPS Port Scan Detected"; flags:S; threshold:type both, track by_src, count 5, seconds 60; sid:4000003; rev:1;)

# 4. Detect Large Data Upload (Potential Data Exfiltration)
# Alerts if a single encrypted packet payload is very large (>1400 bytes).
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"HTTPS Large Data Outbound (Potential Exfil)"; flow:to_server,established; dsize:>1400; sid:4000004; rev:1;)
