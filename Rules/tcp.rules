  GNU nano 7.2                                                                           rules/nmap.rules                                                                                    
# Detects rapid port scanning (e.g., nmap -F). Triggers if 20 SYN packets are sent within 3 seconds.
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg: "TCP SYN scan(fast)"; flags: S; threshold: type both, track by_src, count 20, seconds 3; classtype: network-scan; sid: 2000001; rev: 1;)

# Detects low-and-slow reconnaissance. Triggers if 5 SYN packets are sent within a 60-second window.
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg: "TCP SYN scan(slow)"; flags: S; threshold: type both, track by_src, count 5, seconds 60; classtype: network-scan; sid: 2000002; rev: 1;)

# Detects a NULL scan (nmap -sN). Alerts on TCP packets with no flags set, which is an invalid state.
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg: "TCP NULL scan"; flags: 0; classtype: network-scan; sid: 2000003; rev: 1;)

# Detects a FIN scan (nmap -sF). Alerts on packets with only the FIN flag set to bypass simple firewalls.
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg: "TCP FIN SCAN"; flags: F; classtype: network-scan; sid: 2000004; rev: 1;)

# Detects an XMAS scan (nmap -sX). Alerts on packets with FIN, PSH, and URG flags "lit up like a Christmas tree."
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg: "TCP XMAS scan"; flags: FPU; classtype: network-scan; sid: 2000005; rev:1;)

# Detects a "Port Sweep" where one source hits 50 different ports in 10 seconds to find any open service.
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg: "TCP port sweep"; flags: S; threshold: type both, track by_src, count 50, seconds 10; classtype: network-scan; sid: 2000006; rev: 1;)

# Detects scanning of standard service ports. Triggers if 6 SYN packets are detected within 6 seconds.
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg: "TCP service scan (common ports)"; flags: S; threshold: type both, track by_src, count 6, seconds 6; classtype: network-scan; sid: 2000007; rev: 1;)

# Detects stealthy scans that don't complete handshakes. Uses 'stateless' to ignore the tracking of the session state.
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg: "STEALTH TCP scan (no handshake)"; flags: S; flow: stateless; threshold: type both, track by_src, count 10, seconds 5; classtype: network-scan; sid: 2000008; rev: 1;)


